# Pandas 库的数据类型操作

## 重新索引

.reindex()能够改变或重排Series和DataFrame索引

```python
# .reindex()能够改变或重排Series和DataFrame索引
In [18]: dl ={ '城市':['北京','上海','广州','深圳','沈阳'],
    ...: '环比': [101.5,101.2,101.3,102.0,100.1],
    ...: '同比': [120.7,127.3,119.4,140.9,101.4],
    ...: '定基': [121.4,127.8,120.0,145.5,101.6]}

In [19]: d = pd.DataFrame( dl, index=['c1','c2','c3','c4','c5'])

In [20]: d
Out[20]:
    城市     环比     同比     定基
c1  北京  101.5  120.7  121.4
c2  上海  101.2  127.3  127.8
c3  广州  101.3  119.4  120.0
c4  深圳  102.0  140.9  145.5
c5  沈阳  100.1  101.4  101.6

In [32]: d = d.reindex(['c5','c4','c3','c2','c1'])

In [33]: d
Out[33]:
    城市     环比     同比     定基
c5  沈阳  100.1  101.4  101.6
c4  深圳  102.0  140.9  145.5
c3  广州  101.3  119.4  120.0
c2  上海  101.2  127.3  127.8
c1  北京  101.5  120.7  121.4

In [36]: d = d.reindex(columns=['城市','环比','同比','定基'])

In [37]: d
Out[37]:
    城市     环比     同比     定基
c5  沈阳  100.1  101.4  101.6
c4  深圳  102.0  140.9  145.5
c3  广州  101.3  119.4  120.0
c2  上海  101.2  127.3  127.8
c1  北京  101.5  120.7  121.4
```



.reindex(index=None,columns=None,...)的参数

| 参数           | 说明                                            |
| :------------- | :---------------------------------------------- |
| index, columns | 新的行列自定义索引                              |
| fill_value     | 重新索引中，用语填充缺失位置的值                |
| method         | 填充方法，ffill当前值向前填充，bfill向后填充    |
| limit          | 最大填充值                                      |
| copy           | 默认Ture，生成新的对象，False是，新旧相等不复制 |



```python
In [39]: newc = d.columns.insert(4, '新增')

In [40]: newd = d.reindex(columns=newc, fill_value=200)

In [41]: newd
Out[41]:
    城市     环比     同比     定基   新增
c5  沈阳  100.1  101.4  101.6  200
c4  深圳  102.0  140.9  145.5  200
c3  广州  101.3  119.4  120.0  200
c2  上海  101.2  127.3  127.8  200
c1  北京  101.5  120.7  121.4  200
```



## 索引类型

Series和DataFrame 的索引是Index类型

Index对象是不可修改类型

```python
In [42]: d.index
Out[42]: Index(['c5', 'c4', 'c3', 'c2', 'c1'], dtype='object')

In [43]: d.columns
Out[43]: Index(['城市', '环比', '同比', '定基'], dtype='object')
```



| 方法               | 说明                                   |
| ------------------ | -------------------------------------- |
| .append(idx)       | 连接另一个Index对象，产生新的Index对象 |
| .diff(idx)         | 计算差集，产生新的Index对象            |
| .intersection(idx) | 计算交集                               |
| .union(idx)        | 计算并集                               |
| .delete(loc)       | 删除loc位置处的元素                    |
| .insert(loc,e)     | 在loc位置增加一个元素e                 |



```python

In [44]: nc = d.columns.delete(2)

In [45]: ni = d.index.insert(5,'c0')
    
In [50]: nc
Out[50]: Index(['城市', '环比', '定基'], dtype='object')

In [51]: ni
Out[51]: Index(['c5', 'c4', 'c3', 'c2', 'c1', 'c0'], dtype='object')

In [53]: nd = d.reindex(index=ni, columns=nc).ffill()

In [54]: nd
Out[54]:
    城市     环比     定基
c5  沈阳  100.1  101.6
c4  深圳  102.0  145.5
c3  广州  101.3  120.0
c2  上海  101.2  127.8
c1  北京  101.5  121.4
c0  北京  101.5  121.4
```



## 删除指定索引对象

.drop()能够删除Series和DataFrame指定行或列索引

```python
In [57]: a.drop(['b','c'])
Out[57]:
a    9
d    6
dtype: int64

In [58]: d.drop('c5')
Out[58]:
    城市     环比     同比     定基
c4  深圳  102.0  140.9  145.5
c3  广州  101.3  119.4  120.0
c2  上海  101.2  127.3  127.8
c1  北京  101.5  120.7  121.4

In [59]: d.drop('同比', axis=1)
Out[59]:
    城市     环比     定基
c5  沈阳  100.1  101.6
c4  深圳  102.0  145.5
c3  广州  101.3  120.0
c2  上海  101.2  127.8
c1  北京  101.5  121.4

```



